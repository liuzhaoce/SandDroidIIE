#!/usr/bin/env python
# -*- coding: utf-8 -*-

################################################################################
#
# Copyright (c) 2011-2012, Hu Wenjun (mindmac.hu@gmail.com)
#
# Ministry of Education Key Lab For Intelligent Networks and Network Security
# BotNet Team
# 
# SandDroid is a system to detect Android APK's Vulnerabilities, Now it can check 
# 
# the apk if extra permissions are used,if can be repackaged and if there are  
# 
# exposed components 
#
################################################################################

import traceback
import json

from utils.common import Logger

REPLACE_BYTE = ['\xff','\xfc']
#REPLACE_BYTE = []
TAGS = { 0x1 :   "TAINT_LOCATION",      0x2: "TAINT_CONTACTS",        0x4: "TAINT_MIC",            0x8: "TAINT_PHONE_NUMBER", 
         0x10:   "TAINT_LOCATION_GPS",  0x20: "TAINT_LOCATION_NET",   0x40: "TAINT_LOCATION_LAST", 0x80: "TAINT_CAMERA",
         0x100:  "TAINT_ACCELEROMETER", 0x200: "TAINT_SMS",           0x400: "TAINT_IMEI",         0x800: "TAINT_IMSI",
         0x1000: "TAINT_ICCID",         0x2000: "TAINT_DEVICE_SN",    0x4000: "TAINT_ACCOUNT",     0x8000: "TAINT_BROWSER",
         0x10000: "TAINT_OTHERDB",      0x20000: "TAINT_FILECONTENT", 0x40000: "TAINT_PACKAGE",    0x80000: "TAINT_CALL_LOG",
         0x100000: "TAINT_EMAIL",       0x200000: "TAINT_CALENDAR",   0x400000: "TAINT_SETTINGS" }

class LogcatParser():
    """
    Class to process logcat in Json format
    """
    def __init__(self, theLogger=Logger()):
        
        self.log = theLogger
        
        self.dexClassLoders = [] # DexClassLoader Used
        self.startedServices = [] # Service Started
        
        # Network Operation: Open, Close, Receive, Send
        self.openedNets = []
        self.closedNets = []
        self.receivedNets = []
        self.sentNets = []
        
        self.accessedFiles = {} # 'FdAccess': to get file path
        self.fileRWs = [] # File Read and Write
        
        # Data leakage
        self.leakedDatas = []

        self.phoneCalls = [] # Phone Calls
        self.sentSMSs = [] # SMS Send
        self.cryptOperations = [] # Crypto Operation
        
    def getTags(self,tagParam):
        """
        Retrieve the tag names found within a tag
        """
        
        tagsFound = []
        for tag in TAGS.keys():
            if tagParam & tag != 0:
                tagsFound.append(TAGS[tag])
        return tagsFound
    
    def decode(self, s, encodings=('ascii', 'utf8', 'latin1')):
        for encoding in encodings:
            try:
                return s.decode(encoding)
            except UnicodeDecodeError:
                ex = traceback.format_exc()
                self.log.exce(ex)
                
        return s.decode('ascii', 'ignore')
    
    

    def hexToStr(self, hexStr):
        """
        Convert a string hex byte values into a byte string
        """
     
        bytes = []
        hexStr = ''.join(hexStr.split(" "))
        
        strLen = len(hexStr)
        hexStr = hexStr[:strLen-strLen%2]
        
        for i in range(0, len(hexStr), 2):
            bytes.append(chr(int(hexStr[i:i+2], 16)))
        return ''.join( bytes )
        
    def parseLogcat(self, logEntry):
        """
        Parse Logcat to store the data in specified dict: self.fileRW...
        
        @param logEntry: logcat data in dictionary format 
        """
        # DexClassLoader Used
        if logEntry.has_key('DexClassLoader'):
            self.dexClassLoders.append(logEntry['DexClassLoader'])
        
        # Service Started
        elif logEntry.has_key('ServiceStart'):
            self.startedServices.append(logEntry['ServiceStart'])
            
        # Network Operations
        elif logEntry.has_key('OpenNet'):
            self.openedNets.append(logEntry['OpenNet'])
            
        elif logEntry.has_key('CloseNet'):
            self.closedNets.append(logEntry['CloseNet'])
            
        elif logEntry.has_key('RecvNet'):
            logEntry['RecvNet']['data'] = self.hexToStr(logEntry['RecvNet']['data'])
            for byte in REPLACE_BYTE:
                logEntry['RecvNet']['data'] = logEntry['RecvNet']['data'].replace(byte,'')
            self.receivedNets.append(logEntry['RecvNet'])
            
        elif logEntry.has_key('SendNet'):
            logEntry['SendNet']['data'] = self.hexToStr(logEntry['SendNet']['data'])
            for byte in REPLACE_BYTE:
                logEntry['SendNet']['data'] = logEntry['SendNet']['data'].replace(byte,'')
            self.sentNets.append(logEntry['SendNet'])
            
        # File Operations
        elif logEntry.has_key('FdAccess'):
            self.accessedFiles[logEntry['FdAccess']['id']] = logEntry['FdAccess']['path']
        elif logEntry.has_key('FileRW'):    
            if (self.accessedFiles.has_key(logEntry['FileRW']['id']) 
                and not 'dev/pts' in self.accessedFiles[logEntry['FileRW']['id']]):
                logEntry['FileRW']['path'] = self.accessedFiles[logEntry['FileRW']['id']]
                
                logEntry['FileRW']['path'] = self.hexToStr(logEntry['FileRW']['path'])
                logEntry['FileRW']['data'] = self.hexToStr(logEntry['FileRW']['data'])
                for byte in REPLACE_BYTE:
                    logEntry['FileRW']['path'] = logEntry['FileRW']['path'].replace(byte,'')
                    logEntry['FileRW']['data'] = logEntry['FileRW']['data'].replace(byte,'')
                self.fileRWs.append(logEntry['FileRW'])
                
        # Data Leaks
        elif logEntry.has_key('DataLeak'):
            logEntry['DataLeak']['data'] = self.hexToStr(logEntry['DataLeak']['data'])
            for byte in REPLACE_BYTE:
                logEntry['DataLeak']['data'] = logEntry['DataLeak']['data'].replace(byte,'')
            logEntry['DataLeak']['tag'] = ', '.join(self.getTags(int(logEntry['DataLeak']['tag'], 16)))
            self.leakedDatas.append(logEntry['DataLeak'])

        # Phone Calls
        elif logEntry.has_key('PhoneCall'):
            self.phoneCalls.append(logEntry['PhoneCall'])
        
        # Send SMS
        elif logEntry.has_key('SendSMS'):
            logEntry['SendSMS']['message'] = self.hexToStr(logEntry['SendSMS']['message'])
            self.sentSMSs.append(logEntry['SendSMS'])
            
        # Crypto Used
        elif logEntry.has_key('CryptoUsage'):
            self.cryptOperations.append(logEntry['CryptoUsage'])

#jsonstr1 = '{ "FileRW": { "operation": "read", "data": "0a0a2d2d2d2d2d207069642034353320617420323031322d31302d32342030353a34313a3439202d2d2d2d2d0a436d64206c696e653a2064726f6964626f782e74657374730a0a44414c56494b20544852454144533a0a286d7574657865733a20746c6c3d302074736c3d30207473636c3d302067686c3d302068776c3d302068776c6c3d30290a226d61696e22207072696f3d35207469643d31204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303032336636302073656c663d3078636536300a20207c207379735469643d343533206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d2d313334353030363532380a20207c207363686564737461743d2820353137303636373332203635383030363135382033343320290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e706c6174666f726d2e4f534e6574776f726b53797374656d2e636f6e6e656374496d706c284e6174697665204d6574686f64290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e706c6174666f726d2e4f534e6574776f726b53797374656d2e636f6e6e656374284f534e6574776f726b53797374656d2e6a6176613a3538290a202061742064616c76696b2e73797374656d2e426c6f636b477561726424577261707065644e6574776f726b53797374656d2e636f6e6e65637428426c6f636b47756172642e6a6176613a333537290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e6e65742e506c61696e536f636b6574496d706c2e636f6e6e65637428506c61696e536f636b6574496d706c2e6a6176613a323034290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e6e65742e506c61696e536f636b6574496d706c2e636f6e6e65637428506c61696e536f636b6574496d706c2e6a6176613a343337290a20206174206a6176612e6e65742e536f636b65742e636f6e6e65637428536f636b65742e6a6176613a393833290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e48747470436f6e6e656374696f6e2e3c696e69743e2848747470436f6e6e656374696f6e2e6a6176613a3735290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e48747470436f6e6e656374696f6e2e3c696e69743e2848747470436f6e6e656374696f6e2e6a6176613a3438290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e48747470436f6e6e656374696f6e24416464726573732e636f6e6e6563742848747470436f6e6e656374696f6e2e6a6176613a333232290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e48747470436f6e6e656374696f6e506f6f6c2e6765742848747470436f6e6e656374696f6e506f6f6c2e6a6176613a3839290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e4874747055524c436f6e6e656374696f6e496d706c2e67657448747470436f6e6e656374696f6e284874747055524c436f6e6e656374696f6e496d706c2e6a6176613a323835290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e4874747055524c436f6e6e656374696f6e496d706c2e6d616b65436f6e6e656374696f6e284874747055524c436f6e6e656374696f6e496d706c2e6a6176613a323637290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e4874747055524c436f6e6e656374696f6e496d706c2e7265747269657665526573706f6e7365284874747055524c436f6e6e656374696f6e496d706c2e6a6176613a31303138290a20206174206f72672e6170616368652e6861726d6f6e792e6c756e692e696e7465726e616c2e6e65742e7777772e70726f746f636f6c2e687474702e4874747055524c436f6e6e656374696f6e496d706c2e676574496e70757453747265616d284874747055524c436f6e6e656374696f6e496d706c2e6a6176613a353132290a202061742064726f6964626f782e74657374732e44726f6964426f7854657374732e746573744e6574776f726b485454502844726f6964426f7854657374732e6a6176613a333437290a202061742064726f6964626f782e74657374732e44726f6964426f7854657374732e6f6e4372656174652844726f6964426f7854657374732e6a6176613a3831290a2020617420616e64726f69642e6170702e496e737472756d656e746174696f6e2e63616c6c41637469766974794f6e43726561746528496e737472756d656e746174696f6e2e6a6176613a31303437290a2020617420616e64726f69642e6170702e41637469766974795468726561642e706572666f726d4c61756e636841637469766974792841637469766974795468726561642e6a6176613a31363131290a2020617420616e64726f69642e6170702e41637469766974795468726561642e68616e646c654c61756e636841637469766974792841637469766974795468726561642e6a6176613a31363633290a2020617420616e64726f69642e6170702e41637469766974795468726561642e61636365737324313530302841637469766974795468726561642e6a6176613a313137290a2020617420616e64726f69642e6170702e416374697669747954687265616424482e68616e646c654d6573736167652841637469766974795468726561642e6a6176613a393331290a2020617420616e64726f69642e6f732e48616e646c65722e64697370617463684d6573736167652848616e646c65722e6a6176613a3939290a2020617420616e64726f69642e6f732e4c6f6f7065722e6c6f6f70284c6f6f7065722e6a6176613a313330290a2020617420616e64726f69642e6170702e41637469766974795468726561642e6d61696e2841637469766974795468726561642e6a6176613a33363833290a20206174206a6176612e6c616e672e7265666c6563742e4d6574686f642e696e766f6b654e6174697665284e6174697665204d6574686f64290a20206174206a6176612e6c616e672e7265666c6563742e4d6574686f642e696e766f6b65284d6574686f642e6a6176613a353037290a2020617420636f6d2e616e64726f69642e696e7465726e616c2e6f732e5a79676f7465496e6974244d6574686f64416e644172677343616c6c65722e72756e285a79676f7465496e69742e6a6176613a383339290a2020617420636f6d2e616e64726f69642e696e7465726e616c2e6f732e5a79676f7465496e69742e6d61696e285a79676f7465496e69742e6a6176613a353937290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e6d61696e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233222207072696f3d35207469643d37204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303531333362302073656c663d30783163306365300a20207c207379735469643d343630206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d313935393136380a20207c207363686564737461743d282035373431353035203132323738313833203320290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233122207072696f3d35207469643d36204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303531306264382073656c663d30783164653138380a20207c207379735469643d343539206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d3939343534340a20207c207363686564737461743d28203136353834313036203138343534303135203420290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a224a44575022206461656d6f6e207072696f3d35207469643d3520564d574149540a20207c2067726f75703d2273797374656d222073436f756e743d31206473436f756e743d30206f626a3d307834303530646534382073656c663d307866326164300a20207c207379735469643d343538206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d3939333933360a20207c207363686564737461743d2820313131323935353120323532393438383920313620290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a225369676e616c204361746368657222206461656d6f6e207072696f3d35207469643d342052554e4e41424c450a20207c2067726f75703d2273797374656d222073436f756e743d30206473436f756e743d30206f626a3d307834303530646432382073656c663d307866366337380a20207c207379735469643d343537206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d313031303734340a20207c207363686564737461743d282031323830323030332034383533313435203620290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a22474322206461656d6f6e207072696f3d35207469643d3320564d574149540a20207c2067726f75703d2273797374656d222073436f756e743d31206473436f756e743d30206f626a3d307834303530646332302073656c663d30783163303531380a20207c207379735469643d343536206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d313137313931320a20207c207363686564737461743d28203532343233312035393633313835203220290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2248656170576f726b657222206461656d6f6e207072696f3d35207469643d3220564d574149540a20207c2067726f75703d2273797374656d222073436f756e743d31206473436f756e743d30206f626a3d307834303530646230382073656c663d30783163303365300a20207c207379735469643d343535206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d313137313731320a20207c207363686564737461743d282037353032353435302032323231383735333320313220290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2d2d2d2d2d20656e6420343533202d2d2d2d2d0a0a0a2d2d2d2d2d2070696420373820617420323031322d31302d32342030353a34313a3439202d2d2d2d2d0a436d64206c696e653a2073797374656d5f7365727665720a0a44414c56494b20544852454144533a0a286d7574657865733a20746c6c3d302074736c3d30207473636c3d302067686c3d302068776c3d302068776c6c3d30290a226d61696e22207072696f3d35207469643d31204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303032336636302073656c663d3078636536300a20207c207379735469643d3738206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d2d313334353030363532380a20207c207363686564737461743d28203130323633373632343520313430323339393939392035323820290a2020617420636f6d2e616e64726f69642e7365727665722e53797374656d5365727665722e696e697431284e6174697665204d6574686f64290a2020617420636f6d2e616e64726f69642e7365727665722e53797374656d5365727665722e6d61696e2853797374656d5365727665722e6a6176613a363235290a20206174206a6176612e6c616e672e7265666c6563742e4d6574686f642e696e766f6b654e6174697665284e6174697665204d6574686f64290a20206174206a6176612e6c616e672e7265666c6563742e4d6574686f642e696e766f6b65284d6574686f642e6a6176613a353037290a2020617420636f6d2e616e64726f69642e696e7465726e616c2e6f732e5a79676f7465496e6974244d6574686f64416e644172677343616c6c65722e72756e285a79676f7465496e69742e6a6176613a383339290a2020617420636f6d2e616e64726f69642e696e7465726e616c2e6f732e5a79676f7465496e69742e6d61696e285a79676f7465496e69742e6a6176613a353937290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e6d61696e284e6174697665204d6574686f64290a0a2242696e646572205468726561642023313022207072696f3d35207469643d3435204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303735396563382073656c663d30783130666332300a20207c207379735469643d323533206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323632323430380a20207c207363686564737461743d2820323439313336323833203137333536313330372031373820290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233922207072696f3d35207469643d3434204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303735356531382073656c663d30783237646433380a20207c207379735469643d323436206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323539363935320a20207c207363686564737461743d2820373430393938343136203439343834343239322032303720290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233822207072696f3d35207469643d3432204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303739373365302073656c663d30783239643032380a20207c207379735469643d323138206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323732313332300a20207c207363686564737461743d282034323434303632383320313036333937313038302032313920290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233722207072696f3d35207469643d3431204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303761326161382073656c663d30783239323766300a20207c207379735469643d323137206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323738313633320a20207c207363686564737461743d2820343538303239303130203730343734323833352032323720290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233622207072696f3d35207469643d3333204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303764316630382073656c663d30783235386165300a20207c207379735469643d323136206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323738323736380a20207c207363686564737461743d282036313933363231303920313134383837343332312032303620290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a224770734c6f636174696f6e50726f766964657222207072696f3d35207469643d3430204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303565393036302073656c663d30783234363730380a20207c207379735469643d323037206e6963653d31302073636865643d302f3020636772703d62675f6e6f6e5f696e7465726163746976652068616e646c653d323736363131320a20207c207363686564737461743d28203334333935323632203431323339383332393420313820290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e6174697665506f6c6c4f6e6365284e6174697665204d6574686f64290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e657874284d65737361676551756575652e6a6176613a313139290a2020617420616e64726f69642e6f732e4c6f6f7065722e6c6f6f70284c6f6f7065722e6a6176613a313137290a2020617420636f6d2e616e64726f69642e7365727665722e6c6f636174696f6e2e4770734c6f636174696f6e50726f7669646572244770734c6f636174696f6e50726f76696465725468726561642e72756e284770734c6f636174696f6e50726f76696465722e6a6176613a31353636290a0a2242696e6465722054687265616420233522207072696f3d35207469643d3339204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303765303839302073656c663d30783238396430300a20207c207379735469643d323031206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d313131343536300a20207c207363686564737461743d2820343635393632343633203839393938363032372032343220290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a225468726f74746c655365727669636522207072696f3d35207469643d3338204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303563323937302073656c663d30783261306236380a20207c207379735469643d313635206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323735353734340a20207c207363686564737461743d28203131323837383232362037343037383935393120363020290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e6174697665506f6c6c4f6e6365284e6174697665204d6574686f64290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e657874284d65737361676551756575652e6a6176613a313139290a2020617420616e64726f69642e6f732e4c6f6f7065722e6c6f6f70284c6f6f7065722e6a6176613a313137290a2020617420616e64726f69642e6f732e48616e646c65725468726561642e72756e2848616e646c65725468726561642e6a6176613a3630290a0a224c6f636174696f6e4d616e616765725365727669636522207072696f3d35207469643d3337204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303764323634302073656c663d30783261303039380a20207c207379735469643d313633206e6963653d31302073636865643d302f3020636772703d62675f6e6f6e5f696e7465726163746976652068616e646c653d323735323937360a20207c207363686564737461743d28203238383430303632203234393038373337303920323020290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e6174697665506f6c6c4f6e6365284e6174697665204d6574686f64290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e657874284d65737361676551756575652e6a6176613a313139290a2020617420616e64726f69642e6f732e4c6f6f7065722e6c6f6f70284c6f6f7065722e6a6176613a313137290a2020617420636f6d2e616e64726f69642e7365727665722e4c6f636174696f6e4d616e61676572536572766963652e72756e284c6f636174696f6e4d616e61676572536572766963652e6a6176613a353630290a20206174206a6176612e6c616e672e5468726561642e72756e285468726561642e6a6176613a31303139290a0a227761746368646f6722207072696f3d35207469643d33362054494d45445f574149540a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303531323238302073656c663d30783239333233300a20207c207379735469643d313538206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323730323038380a20207c207363686564737461743d282033303331323832203236373431343638203820290a20206174206a6176612e6c616e672e4f626a6563742e77616974284e6174697665204d6574686f64290a20202d2077616974696e67206f6e203c307834303531323238303e20286120636f6d2e616e64726f69642e7365727665722e5761746368646f67290a20206174206a6176612e6c616e672e4f626a6563742e77616974284f626a6563742e6a6176613a333935290a2020617420636f6d2e616e64726f69642e7365727665722e5761746368646f672e72756e285761746368646f672e6a6176613a343030290a0a2242696e6465722054687265616420233422207072696f3d35207469643d3335204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303738313561302073656c663d30783131303231300a20207c207379735469643d313535206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323232333239360a20207c207363686564737461743d2820323239323338333734203232303436303331392031373520290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a2242696e6465722054687265616420233322207072696f3d35207469643d3334204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303764623365382073656c663d30783235643264300a20207c207379735469643d313436206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d313131343039360a20207c207363686564737461743d2820333332333936343933203730393534393039372032303920290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a226261636b757022207072696f3d35207469643d3332204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303562646266382073656c663d30783130396662300a20207c207379735469643d313331206e6963653d31302073636865643d302f3020636772703d62675f6e6f6e5f696e7465726163746976652068616e646c653d323730333231360a20207c207363686564737461743d282034353139343439203133343133303438363520313020290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e6174697665506f6c6c4f6e6365284e6174697665204d6574686f64290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e657874284d65737361676551756575652e6a6176613a313139290a2020617420616e64726f69642e6f732e4c6f6f7065722e6c6f6f70284c6f6f7065722e6a6176613a313137290a2020617420616e64726f69642e6f732e48616e646c65725468726561642e72756e2848616e646c65725468726561642e6a6176613a3630290a0a22536f756e64506f6f6c22207072696f3d35207469643d3331204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303539633866302073656c663d30783239326264380a20207c207379735469643d313239206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323730323430300a20207c207363686564737461743d2820333935373434203130313633373330203120290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a22536f756e64506f6f6c54687265616422207072696f3d35207469643d3330204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303539633763382073656c663d30783239326161300a20207c207379735469643d313330206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323639353038300a20207c207363686564737461743d28203638303634372039343133373035203120290a202061742064616c76696b2e73797374656d2e4e617469766553746172742e72756e284e6174697665204d6574686f64290a0a22417564696f5365727669636522207072696f3d35207469643d3239204e41544956450a20207c2067726f75703d226d61696e222073436f756e743d31206473436f756e743d30206f626a3d307834303566613266382073656c663d30783239333564300a20207c207379735469643d313238206e6963653d302073636865643d302f3020636772703d64656661756c742068616e646c653d323732333238300a20207c207363686564737461743d2820313534363732373620313834343937333220323120290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e6174697665506f6c6c4f6e6365284e6174697665204d6574686f64290a2020617420616e64726f69642e6f732e4d65737361676551756575652e6e657874284d65737361676551756575652e6a6176613a31313'
##jsonstr = '{ "FileRW": { "operation": "write", "data": "6e756c6c0a", "id": "1268576366" } }'
#parser = LogcatParser()
#print json.loads(jsonstr1)

